<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Migration Flow</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" href="#">
  <style> body {margin: 0; font-family: sans-serif; width: 100vw; height: 100vh; overflow: hidden;}</style>

  <!-- Stylesheet -->
  <link rel="stylesheet" type="text/css" href="./css/main.css">

  <!-- DeckGl library - processing geospatial data-->
  <script src="https://unpkg.com/deck.gl@^8.4.0/dist.min.js"></script>
	<script src="https://unpkg.com/@deck.gl/carto@^8.4.0/dist.min.js"></script>

  <!-- Basemap loading -->
  <link href="https://libs.cartocdn.com/mapbox-gl/v1.13.0/mapbox-gl.css" rel="stylesheet"/>
  <script src="https://libs.cartocdn.com/mapbox-gl/v1.13.0/mapbox-gl.js"></script>

  <!-- Document data manipulation-->
  <script src="https://d3js.org/d3.v4.min.js"></script>

  <!-- Chart plotting -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.0.0/dist/chart.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>

  <!-- JQuery -->
  <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>

  <!-- Add icon library -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">

  <!-- Materilize library - Mainly for the slider-->

</head>




<body>
  <div class="navContainer">
     <div class="logo-box">
        <a href="https://www.uzh.ch/en.html">
        <img src="https://www.geo.uzh.ch/microsite/giva/projects2021/Group9/Webpage/images/uzh_logo_e_pos.svg" height="68px" display="block"></img>
        </a>
     </div>
     <nav>
        <ul>
           <li className="introNav active"><a href="#introNav">Home</a></li>
           <li className="motivationNav"><a href="#motivationNav">motivation</a></li>
           <li className="backgroundNav"><a href="#backgroundNav">background</a></li>
           <li className="mapNav"><a href="#mapNav">map</a></li>
           <li className="summaryNav"><a href="#summaryNav">summary</a></li>
           <li className="referencesNav"><a href="#referencesNav">references</a></li>
           <li className="authorsNav"><a href="#authorsNav">authors</a></li>
        </ul>
     </nav>
  </div>
  <div class="scrollableScreen" id="scrollableScreen">
  <div class="intro page" id="introNav">
     <div class="introWrapper">
        <img class="introImages"src="./images/mig_background.jpg" width="100%" height="100%" >
        <div class="e"><b>Remittance and Migration Flows</b></div>
        <div class="e"> 
           <span class="s">Global Patterns</span>
        </div>
     </div>
  </div>
  <div class="motivation page" id="motivationNav">
    <div class= "text-box-motivation">
      <div class="text-title">Motivation</div>
      <div class="text-box-introduction">
        <div class= "text-section">
          <p style="text-align:justify"> <b>Introduction</b><br>
            <br>
            The Sustainable Development Goals (SDG) are an urgent call for action to reduce all forms of inequality and 
            deprivation as well as to preserve the nature of our planet. These goals are to be achieved by 2030. The SGDs 
            were developed as part of the UN Agenda for Sustainable Development and adopted by all United Nation Member 
            States in 2015. The UN (2021) state the importance of cross-country collaboration. The SDGs cover various topics 
            such as poverty, health, education, inequality, economic growth, and climate change. The different strategies 
            must be coordinated and should empower the achievement of the various goals (UN, 2021). <br><br>
            An annual SDG Progress report is presented by the UN Secretary General collaborating within the UN System. The 
            report is based on the global indicator framework and data produced by national statistical systems and 
            information collected at a regional level (UN, 2021).
            <br>
          </p>
        </div>
      </div>
      <div class="text-box-rq">
        <div class= "text-section">
          <p style="text-align:justify"> <b>Research Questions</b><br>
            <br>
            This project concentrates on migration and remittance as parts of the SDG. Migration and remittance 
            both belong to goal 10: Reduced Inequalities. However, the impact of those is larger than that and 
            they influence the achievement of other goals, as well. In relation to the United Nation goals in general, 
            the research questions of this project are the following: <br>
            
              <li>What migration flows did exist in the last 3 decades? </li>
              <li>The pattern of global financial flows in the past years: Which countries did receive remittances and in which countries more money has been paid? </li>
              <li>What is the linkage between the two phenomena?</li>

          </p>
        </div>
      </div>
      <a href="https://sdgs.un.org">
        <img class="img-sdg" src="./images/SDG_blackwhite.PNG">
      </a>
    </div>
  </div>
  <div class="background page" id="backgroundNav">
     <div class= "text-box">
        <div class="text-title">Background</div>
        <div class="text-box-migration">
          <div class= "text-section">
            <p style="text-align: justify"> <b>Migration</b><br>
              <br>
              Migration is a cross-cutting issue and is relevant to all seventeen SDG goals (Migration Data Portal, no date). It is crucial to understand migration patterns 
              because of its relationship to the goals above. Moreover, there is the SDG of ensuring safe, orderly, and regular migration 
              (UN, 2021). In the future, climate change is likely to increase permanent migration flows substantially (KNOMAD, 2016). 
              According to the Global Knowledge Partnership on Migration and Development (KNOMAD) (2016), the international community 
              lacks a framework to cope with the migration from the affected areas. This Web Page provides an overview of migration and 
              its aftereffect: Remittances. <br>
            </p>
          </div>
        </div>
        <div class="text-box-remittance">
          <div class= "text-section">
            <p style="text-align: justify"> <b>Remittances</b><br>
              <br>
              Remittances are household incomes from foreign countries that result from the temporary or permanent movement of people to 
              those countries (IMF, 2009). In the past years the interest in remittances increased and bridges between academic and political
               spheres were created (Gubert, 2017). A specific United Nation goal is to decrease transaction costs (SDG 10.c) of migrant 
               remittances, as this is one of the most important and mature steps taken to increase incomes in developing countries 
               (IOM, 2017). Concrete examples in the Global Forum on Remittances, Investment and Development (GFRID, 2017) have shown how 
               migrant remittances and diaspora investments were reducing poverty and hunger and promoting access to health and education
                (UN, no date). In addition, migration and remittances help cope with natural disasters and epidemics, as the diaspora can 
                assist in such situations (KNOMAD, 2016)<br>
            </p>
          </div>
        </div>
        <img class="background-image" src="./images/Bild3.jpeg">
        <div class="text-box-video">
          <div class="text-section">
            <p style="text-align: justify"> <b>Dilip Ratha </b> <br>
              <br>
              Dilip Ratha is head of KNOMAD (Global Knowledge Partnership on Migration and Development) and works at the World Bank as the 
              lead economist covering topics concerning Migration and Remittances, Social Protection and Jobs Global Practice. Over three 
              decades, he has done work on migration, remittance, and innovative financing.<br>
              He was born in a village in Odissa, India. Thanks to financial support, he first studied in a town close by, before he 
              fulfilled his dream to study in the United States. Crossing two oceans, Dilip Ratha only had a 20$ bill in his pocket. 
              While taking graduate classes, he worked in a research center. He sent part of his salary back to India to his father and 
              brother.<br>
              Dilip Ratha has a Ph.D. in economics from Indian Statistical Institute. He founded various organizations such as the African 
              Institute of Remittances. In his TED talk he talks about the potential of remittance and its global force in economics (World
               Bank Blogs, no date; Ratha, 2014).
            </p>
          </div>
        </div>
        <div class="ted-talk">
          <iframe width="100%" height="100%" src="https://embed.ted.com/talks/lang/en/dilip_ratha_the_hidden_force_in_global_economics_sending_money_home"
            allowfullscreen=true>
          </iframe>
          <div class="videoOverlay"></div>
        </div>
        <div class="text-box-final">
          <div class= "text-section">
            <p style="text-align: justify">
              In order to approach the reduction of inequalities – especially the remittance costs, it is crucial to better understand the 
              global pattern and dynamics of migration and financial flows between countries. According to the KNOMAD, which has the same objective, this knowledge can be used by policy makers in sending and 
              receiving countries (Gubert, 2017).

            </p>
          </div>
        </div>
      
      
    </div>
  </div>
  <div class="mapPage page" id="mapNav">
     <div class="mapSwitch">
        <span class="mapSpan">Switch between the maps - </span>
        <div class="switch">
           <input type="radio" class="switch-input" name="view" value="migration" id="migration" checked>
           <label for="migration" class="switch-label switch-label-off">Migration</label>
           <input type="radio" class="switch-input" name="view" value="remittance" id="remittance">
           <label for="remittance" class="switch-label switch-label-on">Remittance</label>
           <span class="switch-selection"></span>
        </div>
     </div>
     <div class="migration selectt slide1">
        <div class="mapContainer">
           <div class="map" id="map"></div>
           <div class="arcslegend">
              <div class="text-legend">
                 <p style="font-size:15px;display:inline;text-align:justify"><b>Bilateral Migration Stock from 1990 to 2015</b>
                 <p style="font-size:13px;text-align:justify">Estimated Migration<br> <i>[number of people]</i></p>
                 <div class="legend-break">
                    <span class="lg-area" style="display: inline-block; height: 5px; width: 15px; margin-right: 10px; background-color: rgb(8,104,172);"></span>
                    <span> 0 - 32</span>
                 </div>
                 <div class="legend-break">
                    <span class="lg-area" style="display: inline-block; height: 5px; width: 15px; margin-right: 10px; background-color: rgb(67,162,202);"></span>
                    <span> 33 - 177 </span>
                 </div>
                 <div class="legend-break">
                    <span class="lg-area" style="display: inline-block; height: 5px; width: 15px; margin-right: 10px; background-color: rgb(123,204,196);"></span>
                    <span> 177 - 866</span>
                 </div>
                 <div class="legend-break">
                    <span class="lg-area" style="display: inline-block; height: 5px; width: 15px; margin-right: 10px; background-color: rgb(186,228,188);"></span>
                    <span> 866 - 6'156</span>
                 </div>
                 <div class="legend-break">
                    <span class="lg-area" style="display: inline-block; height: 5px; width: 15px; margin-right: 10px; background-color: rgb(240,249,232)"></span>
                    <span> 6'156 - 10'853'105</span>
                 </div>
                 <p style="font-size:13px;text-align:justify">Net Migration <i>(2010-2015)</i><br> <i>[number of migrants per 1000 inhabitants]</i></p>
                 <div class="legend-break">
                    <span class="lg-area" style="display: inline-block; height: 15px; width: 15px; margin-right: 10px; background-color: rgb(26,60,96);"></span>
                    <span> Negative Net Migration</span>
                 </div>
                 <div class="legend-break">
                    <span class="lg-area" style="display: inline-block; height: 15px; width: 15px; margin-right: 10px; background-color: rgb(120,120,120);"></span>
                    <span> Net Migration ~ 0</span>
                </div>
                <div class="legend-break">
                    <span class="lg-area" style="display: inline-block; height: 15px; width: 15px; margin-right: 10px; background-color: rgb(22,74,41);"></span>
                    <span> Positive Net Migration</span>
                </div>
                <div class="legend-break">
                    <span class="lg-area" style="display: inline-block; height: 15px; width: 15px; margin-right: 10px; background-color: rgb(62,60,60)"></span>
                    <span> <i> No data available</i> </span>
                </div>
              </div>
           </div>
           <button class="mapDesc"><i class="fa-solid fa-info"></i></button>
           <div class="migrationDesc">
              <button class="mapDescClose"><i class="fa-solid fa-xmark"></i></button>
              <div class="descText">
                When clicking on a country its immigration / emigration is displayed, the arcs can be adjusted personally by moving the sliders (width, minimum and maximum of migrants shown).<br><br>
                <i>Navigating on the map: Press Ctrl+left mouse button to change the view angle. Zoom as usual </i>
              </div>
           </div>
           <script type="text/javascript">
             $(".mapDesc").click(function() {
               $(".migrationDesc").css("visibility", "visible");
               $(".mapDesc").css("visibility", "hidden");
             })

             $(".mapDescClose").click(function() {
              $(".migrationDesc").css("visibility", "hidden");
               $(".mapDesc").css("visibility", "visible");
             })
           </script>

        </div>
        <div class="optionBox">
           <fieldset class="layerSelection">
              <legend class="fsTitle">Select a layer:</legend>
              <div class="wrapper">
                 <input type="radio" name="inout" id="option-1" value="e20_w0" onclick="layerChange(this.value)" checked>
                 <input type="radio" name="inout" id="option-2" value="i20_w0" onclick="layerChange(this.value)" >
                 <label for="option-1" class="option option-1">
                    <div class="dot"></div>
                    <span>Immigration</span>
                 </label>
                 <label for="option-2" class="option option-2">
                    <div class="second dot"></div>
                    <span>Emigration</span>
                 </label>
              </div>
           </fieldset>

           <fieldset class="controlPanel">
               
              <legend class="fsTitleControl">Control Panel</legend>

              <div class="controlTitle">Migration Filter</div>            
              <div class="wrapper2">
                <div class="price-input">
                  <div class="field">
                    <span class="minMax">Min</span>
                    <input type="number" class="input-min" value="0">
                  </div>
                  <div class="separator">-</div>
                  <div class="field">
                    <span class="minMax">Max</span>
                    <input type="number" class="input-max" value="2141800">
                  </div>
                </div>
                <div class="slider">
                  <div class="progress"></div>
                </div>
                <div class="range-input">
                  <input type="range" class="range-min" min="0" max="2141800" value="0" step="100">
                  <input type="range" class="range-max" min="0" max="2141800" value="2141800" step="100">
                </div>
              </div>
              <div class="controlTitle">Line Width</div>
              <div class="range-input1">
                <input type="range" min="1" max="7" value="1" step="1">
                <div class="value1">
                  <div></div>
              </div>
            </div>
          </fieldset>

            <script type="text/javascript">
              var currentMax = 0;
              const rangeInput = document.querySelectorAll(".range-input input"),
              priceInput = document.querySelectorAll(".price-input input"),
              range = document.querySelector(".slider .progress");
              range.style.left = "0%";
              range.style.right = "0%";
              let priceGap = 1;
              priceInput.forEach(input =>{
                input.addEventListener("input", e =>{
                  let minPrice = parseInt(priceInput[0].value),
                  maxPrice = parseInt(priceInput[1].value);
                      
                      if((maxPrice - minPrice >= priceGap) && maxPrice <= rangeInput[1].max){
                          if(e.target.className === "input-min"){
                              rangeInput[0].value = minPrice;
                              range.style.left = ((minPrice / rangeInput[0].max) * 100) + "%";
                          }else{
                              rangeInput[1].value = maxPrice;
                              range.style.right = 100 - (maxPrice / rangeInput[1].max) * 100 + "%";
                          }
                      }
                      currentMax = maxPrice;
                      reduceData(currentMax);
                      updateLayers(updateStartCountry, true);
                      
                  });
              });
              rangeInput.forEach(input =>{
                  input.addEventListener("input", e =>{
                      let minVal = parseInt(rangeInput[0].value),
                      maxVal = parseInt(rangeInput[1].value);
                      if((maxVal - minVal) < priceGap){
                          if(e.target.className === "range-min"){
                              rangeInput[0].value = maxVal - priceGap
                          }else{
                              rangeInput[1].value = minVal + priceGap;
                          }
                      }else{
                          priceInput[0].value = minVal;
                          priceInput[1].value = maxVal;
                          range.style.left = ((minVal / rangeInput[0].max) * 100) + "%";
                          range.style.right = 100 - (maxVal / rangeInput[1].max) * 100 + "%";
                      }
                      currentMax = maxVal;
                      reduceData(currentMax);
                      updateLayers(updateStartCountry, true);
                  });
              });
            </script>
             
            
            
            <script type="text/javascript">
              let rangeInput1 = document.querySelector(".range-input1 input");
              let rangeValue1 = document.querySelector(".range-input1 .value1 div");

              let start = parseFloat(rangeInput1.min);
              let end = parseFloat(rangeInput1.max);
              let step = parseFloat(rangeInput1.step);

              for(let i=start;i<=end;i+=step){
                rangeValue1.innerHTML += '<div>'+i+'</div>';
              }
              
              rangeInput1.addEventListener("input",function(){
                let top = (parseFloat(rangeInput1.value)-1)/step * -40;
                rangeValue1.style.marginTop = top+"px";
                scale = rangeInput1.value;
                updateLayers(updateStartCountry, false);
              });
              </script>
            
            
            

          <div class="chartWrapper chartSelector">
            <button type="button" class="expandChart btn"><i class="fa-solid fa-expand"></i></button>
            <canvas id="myChart" height="250"></canvas>
          </div>
        
          <fieldset class="mapInfo">
            <legend class="fsTitleInfo">Information</legend>
            <div class="infoText">
              The map provides information about destination and origin of the migration flows in the past years <i>(1990-2015)</i>. The UN DESA defines an international migrant as someone who has been living for one year or longer in a country other than the one in which he or she was born. The color hue of the countries give an overview about the net migration <i>(2010-2015)</i> of a certain country, as this information cannot be retrieved from the flows.
            </div>
          </fieldset>
        </div>
     </div>
     <div class="remittance selectt slide2">
        <div class="mapContainer">
           <div class="map" id="map_symbols"></div>
           <div class="symbolslegend">
              <div class="text-legend">
                 <p style="font-size:15px;display:inline;text-align:justify"><b>Worldwide Remittance Flows between 2017 and 2020</b>
                 <p style="font-size:15px;text-align:justify">Amount of Remittances received and sent [Mio US$]</p>
                 <div class="legend-break">
                    <span style="display: inline-block; height: 15px; width: 15px; margin-right: 5px; background-color: rgba(255, 187, 67, 150);"></span>
                    <span> Remittance received</span>
                 </div>
                 <div class="legend-break">
                    <span style="display: inline-block; height: 15px; width: 15px; margin-right: 5px; background-color: rgba(109, 160, 111, 100);"></span>
                    <span> Remittances sent</span>
                 </div>
              </div>
           </div>
           <button class="mapDesc"><i class="fa-solid fa-info"></i></button>
           <div class="migrationDesc">
              <button class="mapDescClose"><i class="fa-solid fa-xmark"></i></button>
              <div class="descText">
                By hovering over a symbol, more information about the remittances is revealed. The exact amount of remittance as well as their share to the GDP is shown.<br><br>
                <i>Navigating on the map: Press Ctrl+left mouse button to change the view angle. Zoom as usual </i>
              </div>
           </div>
           <script type="text/javascript">
             $(".mapDesc").click(function() {
               $(".migrationDesc").css("visibility", "visible");
               $(".mapDesc").css("visibility", "hidden");
             })

             $(".mapDescClose").click(function() {
              $(".migrationDesc").css("visibility", "hidden");
               $(".mapDesc").css("visibility", "visible");
             })
           </script>
        </div>
        <div class="optionBox">
           <fieldset class="layerSelection">
              <legend>Select a year:</legend>

              <div class="wrapper">
                <input type="radio" name="layerYear" id="option-4" value="r17" onclick="layerChangeR(this.value)" checked>
                <input type="radio" name="layerYear" id="option-5" value="r18" onclick="layerChangeR(this.value)" >
                <input type="radio" name="layerYear" id="option-6" value="r19" onclick="layerChangeR(this.value)" >
                <input type="radio" name="layerYear" id="option-7" value="r20" onclick="layerChangeR(this.value)" >
                <label for="option-4" class="option option-4">
                   <div class="dot"></div>
                   <span>2017</span>
                </label>
                <label for="option-5" class="option option-5">
                   <div class="dot"></div>
                   <span>2018</span> 
                </label>
                <label for="option-6" class="option option-6">
                  <div class="dot"></div>
                  <span>2019</span>
               </label>
               <label for="option-7" class="option option-7">
                  <div class="dot"></div>
                  <span>2020</span> 
               </label>
             </div>
           </fieldset>
           <fieldset class="mapInfo">
            <legend class="fsTitle">Information</legend>
            <div class="infoText">
              The map provides information about remittances for each country for the years 2017, 2018, 2019, and 2020. The circles show remittances sent or received by resident households to or from nonresident households in US$. The size of the symbols gives an idea about the number of remittances sent or received. A missing symbol indicates lack of data for the specific country. 
            </div> 
           </fieldset>
        </div>

     </div>
     <script type="text/javascript">
        $(".remittance").hide();
        $(document).ready(function() {
            $('input[type="radio"]').click(function() {
                var inputValue = $(this).attr("value");
                var targetBox = $("." + inputValue);
                if(inputValue === "migration" || inputValue ==="remittance"){  
                  showElement = $(targetBox);
                  $(".selectt").not(targetBox).hide();
                  showElement.show();
                }
            });
        });
        
        $(document).ready(function() {
          $('.expandChart').click(function() {
            var chartWrapper = $('.chartSelector');
            if (chartWrapper.hasClass('chartWrapper')) {
              $('.chartWrapper').removeClass("chartWrapper").addClass("chartBigWrapper");
              createPlot(countryNumbers, 15);
            } else {
              $('.chartBigWrapper').removeClass("chartBigWrapper").addClass("chartWrapper")
              createPlot(countryNumbers, 5);
            }
        
          })
        })
     </script>
     </div>
     <div class="summary page" id="summaryNav">
       <div class= "text-box">
         <div class="text-title">Summary</div>
         <div class="text-box-summary1">
           <div class= "text-section"> 
             <p style="text-align: justify"> <b>Local Patterns</b><br>
              <br>
              The map contains a lot of information, we therefore recommend starting to concentrate on a country of interest. 
              Let’s take Nepal as an example: Even if the area does not stand out as prominently as other countries in Asia (e.g. 
              China, India, Philippines), one realizes remittances are crucial for this country when having a closer look at the 
              share of the incoming remittances as a share of the GDP. It contributes about a fourth to the GDP from 2017 to 2020.
               Nepalese are motivated to emigrate the country due to attraction of overseas employment (Gurung, 2020). The 
               destination are, as we can see on the map, the Gulf States, Malaysia, India and the US. Gurung also mentions Korea 
               as a destination country, which isn’t represented in our data and again indicates the lack of reliable migration data
              (2020).<br>
              <br>
              <br>
              <b>Global Patterns</b><br>
              <br>
              To sum up, one can simplify the global pattern of remittances in generalizing in either receiving or sending countries.
               However, there are also countries where the amount of sent and received remittances is equalized, as for example 
               Italy in 2018. In the European region the Balkan States, east-European countries, as well as Portugal and Spain are 
               receiving countries, whereas Greece, Switzerland, Luxembourg, The Netherlands stand out with a high amount of sent 
               remittances. Focusing on Switzerland, the largest immigration flows come among others from Portugal, Spain, 
               northern Macedonia, Serbia and Bosnia-Herzegovina - all receiving countries. Thus, correlations can be made between
                migration data and remittances. Unfortunately, the nature of the migration stock data makes it impossible to 
                highlight large migration corridors that have emerged recently (i.e. Syria – Turkey).
            </p>
          </div>
        </div>
        <div class="summary-question">
          <div class= "text-section">
            <p style="text-align: justify"> <b>TITEL TBCHANGED!!!</b><br>
              <br>
              Dilip Ratha says in his Ted Talk (cf. Background) "my story is not unique", you do not have to go far in your social 
              environment to get in touch with remittances and migration. Think about your social environment in your country and
               the stories of your family and friends. Explore the map: are these stories evident on the map? Such an observation
                about the patterns can be drawn in every region of the world.
           </p>
         </div>
       </div>
        <div class="summary-links">
          <div class= "text-section">
            <p> <b>Further links </b><br>
              <br>
              <b><a href="https://www.knomad.org/sites/default/files/2019-04/Migrationanddevelopmentbrief31.pdf" style="color:#000000">Scientific Literature</a></b> KNOMAD (2019): Migration and Remittances - Recent Developments and Outlook.<br>
              <b><a href="https://ourworldindata.org/grapher/remittance-costs-as-share-of-amount-remitted" style="color:#000000"> Map about Remittance costs</a></b> Our World in Data (2021): Remittance costs as a proportion of the amount remitted, 2021.<br>
              <b><a href="https://worldmigrationreport.iom.int/wmr-2022-interactive/" style="color:#000000"> Interactive World Migration Report</a></b>International Organization for Migration (2022): World Migration Report 2022<br>
           </p>
         </div>
       </div>
        <div class="text-box-summary2">
          <div class= "text-section"> 
            <p style="text-align: justify"><b>Outlook: Reduction of Transaction Costs</b><br>
              <br>
              The relevance to reduce transaction costs is shown by Gubert (2017): a discount for 
              remittance fees lead to a large increase in the number of transactions and the total amount remitted. The SDG 10.c 
              goal could be indeed expedient, however the question of how to stimulate the use of remittances effectively remains (Gubert, 2017). As an outlook, climate change is likely to result in increased 
              frequency and severity of disasters, which then ends in an even higher dependency on remittances (KNOMAD, 2016). 
              As a further step, combined with climate forecasts, remittance dependencies in the future can be identified to go 
              into action to improve the state now and in the future. <br></p>
            </div>
        </div>
        <img class="summary-image" src="./images/remittancecosts_worldbank.jpg">
      </div>
     </div>
     <div class="references page" id="referencesNav">
        <div class= "text-box-r">
           <div class="text-title">References</div>
            <div class="text-box-references">
              <div class= "text-section">
                  <p> <b>Literature</b>
                    <br>
                    <br>Dilip Ratha (2003): ‘Workers' Remittances: An Important and Stable Source of External Development Finance’. <i>Global Development Finance 2003</i>, World Bank.<br>
                    <br>Dilip Ratha (2014): <i>The hidden force in global econimics: sending money home.</i> TED Talk. available at: https://www.ted.com/talks/dilip_ratha_the_hidden_force_in_global_economics_sending_money_home?language=en (accessed: 24.04.2022).<br>
                    <br>Global Knowledge Partnership on Migration and Development (KNOMAD) (2016): <i>Migration and Remittances: Recent Developments and Outlook.</i> Washington DC.<br>
                    <br>Global Knowledge Partnership on Migration and Development (KNOMAD) (2019): <i>Migration and Remittances: Recent Developments and Outlook.</i> Washington DC.<br>
                    <br>Gubert, F. (2017): ‘Migration, Remittances and Development: Insights from the Migration and Development Conference’, <i>Revue d’Economie du Developpement,</i> 25(3–4), pp. 29–44.<br>
                    <br>Gurung, D. K. (2020): ‘Pattern, Structure and Consequences of International Migration in Nepal’, in Banerjee, A., Jana, N. C., and Mishra, V. K. (eds)  <i>Population Dynamics in Contemporary South Asia: Health, Education and Migration.</i> Singapore.<br>
                    <br>International Monetary Fund (IMF) (2009a): <i>Balance of payments and international investment position manual. </i> Washington DC.<br>
                    <br>International Monetary Fund (IMF) (2009b): <i>International Transactions in Remittances: Guide for Compilers and Users.</i> <br>
                    <br>International Organization for Migration (IOM) (2017): ‘Follow-up and review of migration in the sustainable development goals’, <i>No. 26 International dialogue on Migration.</i> Geneva.<br>
                    <br>Migration Data Portal (no date):  <i>Migration data and the Sustainable Development Goals (SDGs).</i> available at: https://www.migrationdataportal.org/sdgs?node=0 (accessed: 14.04.2022).<br>
                    <br>United Nations (UN) (2021): <i>The Sustainable Development Goals Report 2021.</i> available at:  https://unstats.un.org/sdgs/report/2021/ (accessed: 25.04.2022).<br>
                    <br>United Nations (UN) (no date): <i>Putting a spotlight on the role of migrant remittances in achieving the SDGs.</i> available at: https://www.un.org/hi/desa/putting-spotlight-role-migrant-remittances-achieving-sdgs (accessed: 14.04.2022).<br>
                    <br>World Bank Blogs (no date):  <i>Dilip Ratha: Lead economist, Migration and Remittance and Head of KNOMAD.</i>  available at: https://blogs.worldbank.org/team/dilip-ratha (accessed: 24.05 2022).<br>
                    <br>
                    <br>
                    <b>Images</b>
                    <br>
                    <br>Global Knowledge Partnership on Migration and Development (KNOMAD) (2019): <i>Migration and Remittances: Recent Developments and Outlook.</i> Washington DC.<br>
                    <br>United Nations (UN) (no date): <i>Make the SDGS a reality.</i> available at: https://sdgs.un.org/ (accessed: 31.05.2022).<br>

                  </p>
              </div>
            </div>
        </div>
     </div>
     <div class="authors page" id="authorsNav">
        <div class="profile-card">
           <div class="img">
              <img src="./images/annina_stroke_2_cropped.png" ></img>
           </div>
           <div class="caption">
              <h3>Annina Ardüser</h3>
              <p>Master Student GIS</p>
           </div>
           <div class="social-links">
           </div>
        </div>
        <div class="profile-card">
           <div class="img">
              <img src="./images/silvan_stroke_2_cropped.png"></img>
           </div>
           <div class="caption">
              <h3>Silvan Caduff</h3>
              <p>Master Student GIS</p>
              <div class="social-links">
              </div>
           </div>
        </div>
        <div class="profile-card">
           <div class="img">
              <img src="./images/fiona_stroke_2_cropped.png" style="object-fit: scale-down"></img>
           </div>
           <div class="caption">
              <h3>Fiona Federer</h3>
              <p>Bachelor Student</p>
              <div class="social-links">
              </div>
           </div>
        </div>
     </div>
  </div>
</body>




<script language="JavaScript">  

    alert("This Webpage is developed for a display with dimension 2560*1240")

    console.log($('.Embeddable__landing__poster'))

    $('.videoOverlay').click(function(){
      $('.ted-talk').css('filter', 'grayscale(0%)');
      $(this).hide();
      $("iframe")[0].src += "?autoplay=1";
    })


    const pages = document.querySelectorAll('.page');
    const navLi = document.querySelectorAll('nav li');
    const scr = document.getElementById('scrollableScreen');
    
    scr.onscroll = () => {
    var current = "";
    pages.forEach((page) => {
        const pageTop = page.offsetTop;
        if(scr.scrollTop >= (pageTop - 400)) {
        current = page.getAttribute('id');
        }
    });
    
    navLi.forEach((li) => {
        li.classList.remove('active');
        
        if(li.classList.contains(current)){
        li.classList.add('active');
        }
    });
    };

    // Get components from the deckgl library
    const {DeckGL, GeoJsonLayer, ArcLayer, ScatterplotLayer, IconLayer} = deck;


    // Create deck instance symbols
    const deckgl_symbols = new DeckGL({
        mapStyle: 'https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json',
        container: 'map_symbols',
        initialViewState: {
          longitude: 6,
          latitude: 50,
          zoom: 3,
          maxZoom: 15,
          minZoom: 2,
          pitch: 30,
          bearing: 0
        },
        controller: true,
        layers: []
      });

    // colour scheme
    //teal: #d1eeea,#a8dbd9,#85c4c9,#68abb8,#4f90a6,#3b738f,#2a5674

    const POLYGON_COLORS = {
      COLOR_1: [8,81,156, 70], //blue
      COLOR_2: [255,255,255, 60], //grey
      COLOR_3: [0,109,44, 70], //green
      COLOR_nodata: [249,237,237,30]
    };
  
    const ICON_MAPPING_OUT = {
      marker: {x: 1242, y: 0, width: 1242, height: 2479, anchorX: 0, anchorY: 1239.5, mask: true}
    }

    const ICON_MAPPING_IN = {
      marker: {x: 0, y: 0, width: 1242, height: 2479, anchorX: 1300, anchorY: 1239.5, mask: true}
    }

    var data_sorted = [];
    var iconLayer_in = '';
    var iconLayer_out = '';
    var in_out = 'r';
    var year_r = '17';
    var colorD3 = [];

    layerChangeR("r17");

    function layerChangeR(name) {
      fetch('https://raw.githubusercontent.com/sicadu/geovis/main/reactless/data/'+name+'.json')
      .then(res => res.json())
      .then(d => updateLayersR(d));
    }
    
    function updateLayersR(data_r) {

      const iconLayer_out = new IconLayer({
          id:'icon_out',
          data: data_r,
          pickable: true,
          iconAtlas: 'https://raw.githubusercontent.com/sicadu/geovis/main/reactless/images/Remi_in_out.png',
          iconMapping: ICON_MAPPING_OUT,
          getIcon: d => 'marker',
          getPosition: d => [d.X, d.Y],
          getSize: d => (Math.sqrt(d.REMI_O))/2,
          //sizeScale: 10,
          // Option A: if funktion, geht nicht egal ob ''/""/- und auch egal ob (REMI_O !== undefined return 10 oder REMI_O >=0 return 10)
          //sizeMinPixels: d => {
            //if (d.REMI_O == "undefined") {
              //return 0;
            //} 
            //else {
              //return 10;
            //}},

          //Option B: definiere minSize 
          sizeMinPixels: 6,

          //Option C: definiere nichts: alle herausgelöschten Remis werden nicht angezeigt

          //Option D: lösche ganze Geometrien raus, wenn nicht komplett > am wenigsten
          getColor: d => [109, 160, 111, 150]
        });
        
        const iconLayer_in = new IconLayer({
          id: 'icon_in',
          data: data_r,
          pickable: true,
          iconAtlas: 'https://raw.githubusercontent.com/sicadu/geovis/main/reactless/images/Remi_in_out.png',
          iconMapping: ICON_MAPPING_IN,
          getIcon: d => 'marker',
          getPosition: d => [d.X, d.Y],
          getSize: d => (Math.sqrt(d.REMI_I))/2,
          //sizeScale: 0,
          sizeMinPixels: 6,
          /*sizeMinPixels: d => {
            if (d.REMI_I == "undefined" ) {
              return 0;
            }
            else {
              return 10;
            }},*/
          getColor: d => [255, 187, 67, 150],
          pickable: true
        });

        // evtl remittance costs hinzunehmen / remittance cost charts
        deckgl_symbols.setProps({
          layers: [iconLayer_in, iconLayer_out, backgroundMap_symbols],
          getTooltip: ({object}) => object && {
            html: `
            <p><b> Country: </b>${object.COUNTRY}</p>
            <p><b> Remittances received: </b>${object.REMI_I} Mio. | ${(object.REMI_I*100000000/object.GDP).toFixed(2)}% of GDP</p>
            <p><b> Remittances sent: </b>${object.REMI_O} Mio. | ${(object.REMI_O*100000000/object.GDP).toFixed(2)}% of GDP</p>
            `,
            style: {
              color: '#000000',
              fontSize: '0.2em',
              backgroundColor: '#f5f5f5',
              opacity: 0.85
            }
          }});
    }

    // create choropleth map  
    const choroplethMap = new GeoJsonLayer({
      data: 'https://raw.githubusercontent.com/sicadu/geovis/main/reactless/data/netMig_2010_2015_2020.json',
      pickable: true,
      stroked: true,
      filled: true,
      wireframe: true,
      getPolygon: d => d.features.geometry.coordinates,
      getLineColor: [150,150,150],
      getLineWidth: 1,
      lineWidthMinPixels: 1,
      getFillColor: a => {
        if (a.properties.F2010_2015 == null) {
          return POLYGON_COLORS.COLOR_nodata
        }
        else if (a.properties.F2010_2015 < -1.0) {
          return POLYGON_COLORS.COLOR_1; //negative Net Migration = blue
        } 
        else if (a.properties.F2010_2015 < 1.0) {
          return POLYGON_COLORS.COLOR_2; //~0 = grey
        } 
        else if (a.properties.F2010_2015 < 55.0) {
          return POLYGON_COLORS.COLOR_3; //positive Net Migation = green
        };
      },
    });


    const backgroundMap_symbols = new GeoJsonLayer({
      data: 'https://raw.githubusercontent.com/sicadu/geovis/main/reactless/data/WorldCountries.geojson',
      pickable: true,
      stroked: true,
      filled: false,
      wireframe: true,
      getPolygon: d => d.features.geometry.coordinates,
      getLineColor: [150,150,150],
      getLineWidth: 0.3,
      lineWidthMinPixels: 1,
    });



    // Create deck instance arcs
    const deckgl = new DeckGL({
        mapStyle: 'https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json',
        container: 'map',
        initialViewState: {
          longitude: 6,
          latitude: 50,
          zoom: 3,
          maxZoom: 15,
          pitch: 30,
          bearing: 0
        },
        controller: true,
        layers: []
      });



    
    // Define Arc colors -- Color with colorBrewer sequential 5 Colors 
    const inFlowColors = [ 
      [237,248,251],
      [178,226,226],
      [102,194,164],
      [44,162,95],
      [0,109,44]
    ];


    [237,248,251],[178,226,226],[102,194,164],[44,162,95],[0,109,44]
    const outFlowColors = [
      [240,249,232],
      [186,228,188],
      [123,204,196],
      [67,162,202],
      [8,104,172],
    ];

    

    var dataSorted = [];
    var countyLayer = '' ;
    var arcLayer = '';
    var countryNumbers;
    var migration = 'e20_w0'
    var startCountry = 'GERMANY';
    var breaks_e = [32, 177, 866, 6156, 10853105];
    var breaks_i = [25, 136, 693, 5097, 11643298];
    var scale = 1;
    var arc_data;
    var updateStartCountry;

    const widthScale = () => scale

    layerChange("e20_w0");

    function layerChange(layerName) {
      migration = layerName;
      fetch('https://raw.githubusercontent.com/sicadu/geovis/main/reactless/data/'+layerName+'.json')
      .then(res => res.json())
      .then(data => {
        arc_data = data
        dataSorted = keysrt(data.features, ['properties','COUNTRY']);
        updateLayers(
          dataSorted.find(f => f.properties.COUNTRY === startCountry), true
        );
        countyLayer = new GeoJsonLayer({
          id: 'geojson',
          data,
          stroked: true,
          getFillColor: [0,0,0,0],
          getLineColor: [240,249,232],
          onClick: info => updateLayers(info.object, true, true),
          pickable: true
        });
      }); 
      if (layerName === 'e20_w0'){
        updateLegend(inFlowColors, breaks_e);
      } else {
        updateLegend(outFlowColors, breaks_i);
      }
    }

    
  

    var oldTopValue,
    percentage,
    maxRangeSet,
    topValue;

    function updateLayers(dataFeature, truePlot, rangeSet=false) {
        selectedFeature = dataSorted.find(f => f.properties.COUNTRY === dataFeature.properties.COUNTRY);
        updateStartCountry = dataFeature; 
        startCountry = dataFeature.properties.COUNTRY;

        const flows = selectedFeature.properties.flows;
        const centroid = selectedFeature.geometry.centroid;

        const arcs = Object.keys(flows).map(toId => {

          const f = dataSorted[toId];
          return {
            source: centroid,
            target: f.geometry.centroid,
            value: flows[toId]
          };
        });

        countryNumbers = Object.keys(flows).map(toId => {
          const r = dataSorted[toId];
          return {
            country: r.properties.COUNTRY,
            migration: flows[toId]
          };
        });

        colorList(arcs);
        if(truePlot){createPlot(countryNumbers, 5, filterFromTop);}
        
        oldTopValue = topValue ? topValue : 2141800
        topValue = getTopN(countryNumbers, 'migration', 1)[0]['migration'];
        percentage = 100 - (oldTopValue/topValue * 100);
        
        maxRangeSet = percentage >= 0 ? percentage : 0;
        

        if(rangeSet){
          range.style.right = maxRangeSet + '%';
          priceInput[1].value = topValue;
          rangeInput[1].value = topValue;
          rangeInput[1].max = topValue + 100;
          rangeInput[0].max = topValue + 100;
        }

        arcLayer = new ArcLayer({
          id: 'arc',
          data: arcs,
          getSourcePosition: d => d.source,
          getTargetPosition: d => d.target,
          getSourceColor: d => checkBreaksForColor(d.value),
          getTargetColor: d => checkBreaksForColor(d.value),
          widthMinPixels: 1, /* Breite von Linien*/
          getWidth: d => {checkBreaksForWidth(d.value)},
          getHeight: 0.5,
          widthScale: scale,
          updateTriggers: {
            widthScale: [scale]
          },
          getFilterValue: d => d.value,
          filterRange: [parseInt(priceInput[0].value), parseInt(priceInput[1].value)],
          extensions: [new deck.DataFilterExtension({filterSize: 1})]
        });

        deckgl.setProps({
          layers: [choroplethMap, countyLayer, arcLayer]
        });
    }

    function updateScaleWidth() {
      arcLayer.setProps({ 
        widthScale,
        updateTriggers: {
          widthScale: scale
        }
      });
    };

    function keysrt(arr, keyArr, reverse) {
          var sortOrder = 1;
          if(reverse)sortOrder = -1;
          return arr.sort(function(a, b) {
              var x=a,y=b;
              for (var i=0; i < keyArr.length; i++) {
                x = x[keyArr[i]];
                y = y[keyArr[i]];
              }
              return sortOrder * ((x < y) ? -1 : ((x > y) ? 1 : 0));
          });
      }
  

    
    function reduceData(filterValue) {
      var predicateBigger = (x) => x < filterValue;
      filterFromTop = topCountriesValues.length - topCountriesValues.filter(predicateBigger).length;
    } 

    var myChart, migrationValues, countryMigration, topCountries, countryKey, topCountriesValues;
    var filterFromTop = 1000000000;

    function createPlot(data, n, filter = 0){
      if (myChart){
        myChart.destroy();
      }
      countryMigration = data;


      topCountries = getTopN(data, 'migration', data.length);

      topCountriesValues = [];

      for (let i = 0; i<data.length ;i++){
        topCountriesValues.push(topCountries[i]['migration'])
      }

      migrationValues = [];
      countryKey = [];

      for (let i = filter; i<n+filter ;i++) {
        migrationValues.push(topCountries[i]['migration']);
        countryKey.push(topCountries[i]['country']);
      } 

      //Chart.register(ChartDataLabels)

      const config = {
        type: 'bar',
        data: {
          labels: countryKey,
          datasets: [
            {
              backgroundColor: colorD3,
              data: migrationValues, /*
              datalabels: {
                color: 'white',
                anchor: 'end',
                align: 'start',

              }*/
            }
          ]
        },
        options: {
          animation: {
            duration: 0
          },
          maintainAspectRatio: false,
          indexAxis: 'y',
          plugins: {
            title: {
              display: true, 
              text: 'Top Migration',
              font: {
                size: 20,
              }},
            legend: {display: false},
            tooltips: {enabled: false}
          },
          scales: {
            y: {
              beginAtZero: true
            }
          }
        },
        //plugins: [ChartDataLabels]
      };

      myChart = new Chart(
        document.getElementById('myChart'),
        config
      );
    }

    function getTopN(arr, prop, n) {
      // clone before sorting, to preserve the original array
      var clone = arr.slice(0); 

      // sort descending
      clone.sort(function(x, y) {
          if (x[prop] == y[prop]) return 0;
          else if (parseInt(x[prop]) < parseInt(y[prop])) return 1;
          else return -1;
      });

      return clone.slice(0, n || 1);
    }

    function colorList(arr) {
      colorD3 = [];
      for (var i = 0; i < arr.length; i++) {
        color_rgb = checkBreaksForColor(arr[i]);
        color_hex = rgbToHex(color_rgb[0], color_rgb[1], color_rgb[2]);
        colorD3.push(color_hex);
      }
    }

    // helper function for colorList
    function componentToHex(c) {
      var hex = c.toString(16);
      return hex.length == 1 ? "0" + hex : hex;
    }

    function rgbToHex(r, g, b) {
      return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
    }
  
    window.addEventListener("scroll", () => {
      if (window.pageYOffset > 100) {
        toTop.classList.add("active");
      } else {
        toTop.classList.remove("active");
      }
    })

    function checkBreaksForColor(color){
      if (migration == 'e20_w0') {
        if (color < breaks_e[0]){
          return inFlowColors[0]
        } else if (color < breaks_e[1]){
          return inFlowColors[1]
        } else if (color < breaks_e[2]){
          return inFlowColors[2]
        } else if (color < breaks_e[3]){
          return inFlowColors[3]
        } else {
          return inFlowColors[4]
        }
      } else {
        if (color < breaks_i[0]){
          return outFlowColors[0]
        } else if (color < breaks_i[1]){
          return outFlowColors[1]
        } else if (color < breaks_i[2]){
          return outFlowColors[2]
        } else if (color < breaks_i[3]){
          return outFlowColors[3]
        } else {
          return outFlowColors[4]
        }

      }
    }

    function checkBreaksForWidth(color){
      if (color < breaks_e[0]){
        return 1
      } else if (color < breaks_e[1]){
        return 4
      } else if (color < breaks_e[2]){
        return 7
      } else if (color < breaks_e[3]){
        return 10
      } else {
        return 13
      }
    }

    
  function updateLegend(sign, breaks){
    legend_spans = $('.legend-break span');
    legendNumbers = [... breaks];
    legendNumbers.unshift(0);
    console.log(legend_spans[1])
    legend_spans[1].textContent = (legendNumbers[0] + " - " + legendNumbers[1])
    legend_spans[3].textContent = (legendNumbers[1]+1 + " - " + legendNumbers[2])
    legend_spans[5].textContent = (legendNumbers[2]+1 + " - " + legendNumbers[3])
    legend_spans[7].textContent = (legendNumbers[3]+1 + " - " + legendNumbers[4])
    legend_spans[9].textContent = (legendNumbers[4]+1 + " - " + legendNumbers[5])


    legend_colors = $('.lg-area');
    for (let i = 0; i < legend_colors.length; i++){
        legend_colors[i].style.backgroundColor = "rgb(" + sign[4-i][0] + "," + sign[4-i][1] + "," + sign[4-i][2] + ")";
    }
  }
  
  
  </script>